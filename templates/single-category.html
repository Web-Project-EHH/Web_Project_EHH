{% extends "base.html" %}
{% block title %}{{ category.name }} - Forum{% endblock %}
{% block content %}
    <section id="single_category">
        {% if get_user(request) %}
            {% if category %}
            <h2>{{ category.name }}</h2>
                {% if get_user(request).is_admin %}
                    <div class="category-actions">

                    <form action="/categories/{{category.id}}/delete" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="DELETE">
                    <button id="delete-category" type="submit" class="btn btn-danger">Delete</button>

                    {% if not category.is_locked %}
                    <form action="/categories/{{category.id}}/lock" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="PATCH">
                        <button id="lock-category" type="submit" class="btn btn-warning">Lock</button>
                    </form>

                    {% else %}
                    <form action="/categories/{{category.id}}/unlock" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="PATCH">
                        <button id="unlock-category" type="submit" class="btn btn-warning">Unlock</button>
                    </form>
                    {% endif %}

                    {% if not category.is_private %}
                    <form action="/categories/{{category.id}}/make_private" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="PATCH">
                        <button id="privatise-category" type="submit" class="btn btn-danger">Make Private</button>
                    </form>

                    {% else %}
                    <form action="/categories/{{category.id}}/make_private" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="PATCH">
                        <button id="unprivatise-category" type="submit" class="btn btn-danger">Make Public</button>
                    </form>
                    {% endif %}
                </div>
                {% endif %}
            {% else %}
            <p>Category not found.</p>
            {% endif %}
            {% if topics %}
            {{ load_topics(topics, user=get_user(request)) }}
            {% else %}
            <p>No topics found.</p>
            {% endif %}
        {% else %}
        <p>You need to be logged in to view this category.</p>
        {% endif %}
    </section>
{% endblock %}